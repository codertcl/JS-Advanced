<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

<input type="text">
<button id="cancel">取消</button>

<!--  <script src="https://cdn.jsdelivr.net/npm/underscore@1.13.1/underscore-umd-min.js"></script>-->
<!--<script src="./01_debounce-v1-基本实现.js"></script>-->
<!--<script src="./02_debounce-v2-this-参数.js"></script>-->
<!--<script src="./03_debounce-v3-立即执行.js"></script>-->
<!--<script src="./04_debounce-v4-取消功能.js"></script>-->
<script src="./05_debounce-v5-函数返回值.js"></script>
<script>
    const inputEl = document.querySelector("input")
    let counter = 0
    const inputChange = function (event) {
        console.log(`发送了第${++counter}次网络请求`, this, event)
        return "aaaaaaa"
    }

    //// 防抖处理
    ////1:underscore实现防抖
    // inputEl.oninput = _.debounce(inputChange, 1000)
    ////2:基本实现fn未传入参数
    // inputEl.oninput = debounce(inputChange, 1000)

    // //3:是否立即执行 true表示立即执行 没传或者为false表示不需要立即执行
    // const debounceChange = debounce(inputChange, 1000, true)
    // inputEl.oninput = debounceChange
    //
    // 4:取消功能
    const debounceChange = debounce(inputChange, 1000, true)
    const cancelBtn = document.querySelector("#cancel")
    cancelBtn.onclick = function () {
        debounceChange.cancel()
    }

    ////5:函数返回值
    ////5.1回调函数获取返回值
    // inputEl.oninput = debounce(inputChange, 1000, true, (res) => {
    //     console.log("拿到真正执行函数的返回值:", res)
    // })

    ////5.2 Promise.resolve(返回值)
    const tempCallback = () => {
        debounceChange().then(res => {
            console.log("Promise的返回值结果:", res)
        })
    }
    inputEl.oninput = tempCallback
</script>
</body>
</html>
